<ion-card (click)="onCardClick()" class="character-card">
  <div class="card-image">
    <img 
      [src]="character.image" 
      [alt]="character.name"
      class="character-image"
      (error)="onImageError($event)"
    />
    
    <!-- Botón de favoritos -->
    <ion-button 
      fill="clear" 
      class="favorite-btn"
      (click)="onFavoriteClick($event)"
      [attr.aria-label]="isFavorite ? 'Quitar de favoritos' : 'Agregar a favoritos'"
    >
      <ion-icon 
        [name]="isFavorite ? 'heart' : 'heart-outline'" 
        [color]="isFavorite ? 'danger' : 'light'"
      ></ion-icon>
    </ion-button>

    <!-- Badge de universo -->
    <div class="universe-badge">
      {{ character.universe }}
    </div>

    <!-- Rating -->
    <div class="rating-badge" *ngIf="character.rating">
      <ion-icon name="star"></ion-icon>
      {{ character.rating | number:'1.1-1' }}
    </div>
  </div>

  <ion-card-header>
    <ion-card-title class="character-name">{{ character.name }}</ion-card-title>
    
    <!-- Aliases -->
    <div class="aliases" *ngIf="character.aliases && character.aliases.length > 0">
      <small>"{{ character.aliases[0] }}"</small>
    </div>

    <ion-card-subtitle>
      <!-- Chip de afiliación -->
      <ion-chip 
        [color]="getAffiliationColor(character.affiliation)" 
        outline
        class="affiliation-chip"
      >
        <ion-icon [name]="getAffiliationIcon(character.affiliation)"></ion-icon>
        <ion-label>{{ character.affiliation }}</ion-label>
      </ion-chip>

      <!-- Primera aparición -->
      <ion-chip color="medium" outline *ngIf="character.firstAppearance">
        <ion-icon name="calendar"></ion-icon>
        <ion-label>{{ character.firstAppearance }}</ion-label>
      </ion-chip>
    </ion-card-subtitle>
  </ion-card-header>

  <ion-card-content>
    <!-- Biografía/Descripción -->
    <p class="biography">
      {{ character.biography || 'Sin biografía disponible' }}
    </p>
    
    <!--Sección de poderes -->
    <div class="powers-minimalist" *ngIf="character.powers && character.powers.length > 0">
      <div class="powers-tags">
        <span class="power-tag" *ngFor="let power of character.powers.slice(0, 2)">
          {{ power }}
        </span>
        <span class="power-more" *ngIf="character.powers.length > 2">
          +{{ character.powers.length - 2 }}
        </span>
      </div>
    </div>

    <!-- Estadísticas de poder rápidas -->
    <div class="quick-stats" *ngIf="character.powerStats">
      <div class="stat-row">
        <div class="stat-item">
          <small>Fuerza</small>
          <ion-badge [color]="getStatColor(character.powerStats.strength)">
            {{ character.powerStats.strength }}
          </ion-badge>
        </div>
        <div class="stat-item">
          <small>Velocidad</small>
          <ion-badge [color]="getStatColor(character.powerStats.speed)">
            {{ character.powerStats.speed }}
          </ion-badge>
        </div>
        <div class="stat-item">
          <small>Inteligencia</small>
          <ion-badge [color]="getStatColor(character.powerStats.intelligence)">
            {{ character.powerStats.intelligence }}
          </ion-badge>
        </div>
      </div>
    </div>

    <!-- Nivel de poder general -->
    <div class="power-summary" *ngIf="character.powerStats">
      <div class="power-level">
        <small>Poder Total</small>
        <ion-progress-bar 
          [color]="getPowerLevelColor(getPowerLevel(character.powerStats))"
          [value]="getPowerLevel(character.powerStats) / 100"
        ></ion-progress-bar>
        <span class="power-value">{{ getPowerLevel(character.powerStats) }}%</span>
      </div>
    </div>
  </ion-card-content>
</ion-card>